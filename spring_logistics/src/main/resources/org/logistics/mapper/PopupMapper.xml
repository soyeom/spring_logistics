<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace = "org.logistics.mapper.PopupMapper">
	
	<select id = "item_List" resultType = "org.logistics.domain.PopupVO">
		
		select item_Id as column1, spec as column2, item_name as column3
		     , asset_class as column4
		     , small_category as column5
		     , base_unit as column6 
		     , sales_unit as column7 
		     , english_name as column8 
		from item_master
		
		<where>
	        <if test = "gubun == 10">
	            item_Id like '%' ||  #{text} || '%'
	        </if>
	        <if test = "gubun == 20">
	        	item_name like '%' ||  #{text} || '%'
	        </if>
    	</where>
		
	</select>
	
	<select id = "contact_List" resultType = "org.logistics.domain.PopupVO">
	
		select contact_id as column1
		     , contact_name column2
		     , department as column3
		     , phone as column4
		     , mobile as column5
		     , email as column6
		from contact
		<where>
	        <if test = "gubun == 10">
	            contact_id like '%' ||  #{text} || '%'
	        </if>
	        <if test = "gubun == 20">
	        	contact_name like '%' ||  #{text} || '%'
	        </if>
    	</where>
	
	</select>
	
	<select id = "category_List_Big" resultType = "org.logistics.domain.PopupVO">
	
		select item_id as column1
		     , big_category as column2
		from item_master
		<where>
	        <if test = "gubun == 10">
	            big_category like '%' ||  #{text} || '%'
	        </if>
    	</where>
	
	</select>
	
	<select id = "category_List_Mid" resultType = "org.logistics.domain.PopupVO">
	
		select item_id as column1
		     , big_category as column2
		     , mid_category as column3
		from item_master
		<where>
	        <if test = "gubun == 10">
	            mid_category like '%' ||  #{text} || '%'
	        </if>
    	</where>
	
	</select>
	
	<select id = "category_List_Small" resultType = "org.logistics.domain.PopupVO">
	
		select item_id as column1
		     , big_category as column2
		     , mid_category as column3
		     , small_category as column4
		from item_master
		<where>
	        <if test = "gubun == 10">
	            small_category like '%' ||  #{text} || '%'
	        </if>
    	</where>
	
	</select>
	
	<select id = "itemname_List" resultType = "org.logistics.domain.PopupVO">
	
		select item_id as column1
			, spec as column2
			, item_name as column3
			, asset_class as column4
			, small_category as column5
			, base_unit as column6
			, english_name as column7
		from item_master
		
		<where>
			<if test = "gubun == 10">
				item_name like '%' || #{text} || '%'
			</if>
			<if test = "gubun == 20">
				item_id like '%' || #{text} || '%'
			</if>
			<if test = "gubun == 30">
				spec like '%' || #{text} || '%'
			</if>
			<if test = "gubun == 40">
				english_name like '%' || #{text} || '%'
			</if>
		</where>
	
	</select>
    
        <select id="warehousecode_List" resultType="org.logistics.domain.PopupVO">
        SELECT DISTINCT warehouse_internal_code AS column1
             , warehouse_internal_code           AS column2
        FROM warehouse_master
        <where>
            <if test="gubun == '10'">
                warehouse_internal_code LIKE '%' || #{text} || '%'
            </if>
        </where>
    </select>
    
        <select id="warehousename_List" resultType="org.logistics.domain.PopupVO">
        SELECT DISTINCT w.warehouse_id   AS column1
             , w.warehouse_name          AS column2
             , w.bu_id                   AS column3
        FROM warehouse_detail w
        <where>
            <if test="gubun == '10'">
                w.warehouse_name LIKE '%' || #{text} || '%'
            </if>
        </where>
  </select>
	
	
	 <!-- ================== 수주번호 (inbound_master) ================진형== --> 
 <select id="inboundMaster_List" resultType="org.logistics.domain.PopupVO">
    SELECT ib.inbound_id       AS column1,
           bu.bu_name          AS column2,
           TO_CHAR(ib.inbound_date, 'YYYY-MM-DD') AS column3,
           ib.local_flag       AS column4,
           p.party_name        AS column5,
           c.contact_name      AS column6,
           ib.inbound_type     AS column7,
           ib.inbound_complete AS column8,
           TO_CHAR(ib.created_at, 'YYYY-MM-DD') AS column9,
           p.party_id          AS column10,   -- 거래처번호
           c.department        AS column11,    -- 부서
           bu.bu_id            AS column12
    FROM inbound_master ib
    JOIN business_unit bu ON ib.bu_id = bu.bu_id
    JOIN party p          ON ib.party_id = p.party_id
    JOIN contact c        ON ib.contact_id = c.contact_id  <!-- ✅ INNER JOIN -->
    <where>
        <if test="gubun == '10'">
            ib.inbound_id LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '20'">
            bu.bu_name LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '30'">
            TO_CHAR(ib.inbound_date, 'YYYY-MM-DD') LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '40'">
            ib.local_flag LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '50'">
            p.party_name LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '60'">
            c.contact_name LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '70'">
            ib.inbound_type LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '80'">
            ib.inbound_complete LIKE '%' || #{text} || '%'
        </if>
        <if test="gubun == '90'">
            TO_CHAR(ib.created_at, 'YYYY-MM-DD') LIKE '%' || #{text} || '%'
        </if>
    </where>
</select>

</mapper>