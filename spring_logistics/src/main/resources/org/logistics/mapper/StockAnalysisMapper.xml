<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="org.logistics.mapper.StockAnalysisMapper">

    <!-- 품목 조회 -->
    <select id="getStockAnalysisData"
        parameterType="org.logistics.domain.StockAnalysisRequestDTO"
        resultType="org.logistics.domain.StockAnalysisResponseDTO">
    SELECT 
        im.asset_class    AS itemAssetClass,
        im.big_category   AS itemBigCategory,
        im.mid_category   AS itemMidCategory,
        im.small_category AS itemSmallCategory,
        im.item_id        AS itemId,
        im.item_name      AS itemName,
        im.spec           AS spec,
        im.base_unit      AS baseUnit
    FROM item_master im
    WHERE 1=1
    <if test="buId != null">
        AND im.bu_id = #{buId}
    </if>
    <if test="itemName != null and itemName != ''">
        AND im.item_name LIKE '%' || #{itemName} || '%'
    </if>
    <if test="spec != null and spec != ''">
        AND im.spec LIKE '%' || #{spec} || '%'
    </if>
    ORDER BY im.item_name
    <if test="itemAssetClass != null and itemAssetClass != ''">
    AND im.asset_class = #{itemAssetClass}
</if>
    
</select>


</mapper>
